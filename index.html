<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Maintenance Window - World Clock</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* Theme variables */
    :root {
      --bg-grad-a: #74ebd5;
      --bg-grad-b: #9face6;
      --card-bg: rgba(255,255,255,0.12);
      --card-shadow: rgba(0,0,0,0.15);
      --text-color: #333;
      --card-text: #fff;
      --accent: #222;
      --search-bg: #fff;
    }
    .dark {
      --bg-grad-a: #0f1724;
      --bg-grad-b: #0b1220;
      --card-bg: rgba(255,255,255,0.04);
      --card-shadow: rgba(0,0,0,0.45);
      --text-color: #e6eef6;
      --card-text: #fff;
      --accent: #f3f4f6;
      --search-bg: #0f1724;
    }

    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: linear-gradient(135deg, var(--bg-grad-a), var(--bg-grad-b));
      padding: 20px;
      color: var(--text-color);
      transition: background 200ms ease, color 200ms ease;
    }

    h1 { margin-bottom: 10px; color: var(--text-color); font-size: 32px; }
    p { margin-bottom: 25px; font-size: 18px; color: var(--text-color); }

    .search-container input {
      padding: 10px;
      font-size: 18px;
      width: 280px;
      border-radius: 6px;
      border: 1px solid rgba(0,0,0,0.08);
      background: var(--search-bg);
      color: var(--text-color);
    }

    .search-result {
      background: #fff3b0;
      border-radius: 10px;
      padding: 14px;
      margin: 10px auto;
      width: 330px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.18);
      text-align: left;
      color: #222;
      font-size: 16px;
      font-weight: 600;
    }

    .clock-container {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 18px;
    }

    .clock {
      border-radius: 12px;
      padding: 20px;
      width: 260px;
      box-shadow: 0 6px 12px var(--card-shadow);
      transition: transform 0.16s ease, background 200ms ease;
      font-weight: 700;
      font-size: 18px;   /* bigger text inside clock */
      color: var(--card-text);
      background: var(--card-bg);
      -webkit-backdrop-filter: blur(6px);
      backdrop-filter: blur(6px);
    }
    .clock:hover { transform: scale(1.04); }

    /* color accents for cards (kept same) */
    .clock:nth-child(1) { background: linear-gradient(135deg, #FFD700, #FFA500); color:#222; }
    .clock:nth-child(2) { background: linear-gradient(135deg, #4facfe, #00f2fe); color:#222; }
    .clock:nth-child(3) { background: linear-gradient(135deg, #f6d365, #fda085); color:#222; }
    .clock:nth-child(4) { background: linear-gradient(135deg, #a1c4fd, #c2e9fb); color:#222; }
    .clock:nth-child(5) { background: linear-gradient(135deg, #667eea, #764ba2); color:#fff; }
    .clock:nth-child(6) { background: linear-gradient(135deg, #f6e3b4, #f7c59f); color:#222; }
    .clock:nth-child(7) { background: linear-gradient(135deg, #81ecec, #00cec9); color:#222; }
    .clock:nth-child(8) { background: linear-gradient(135deg, #ff9a9e, #fecfef); color:#222; }

    .clock h3 {
      font-size: 22px;
      margin-bottom: 10px;
      color: inherit;
    }

    input[type="date"], input[type="time"]{
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: none;
      background: rgba(255,255,255,0.4);
      color: #000;
      font-size: 20px;     /* bigger numbers */
      font-weight: 700;
      text-align: center;
      margin-top: 8px;
    }

    .dst-info {
      margin-top: 36px;
      background: #ffeef0;
      padding: 14px;
      border-radius: 10px;
      width: 92%;
      max-width: 640px;
      margin-left: auto;
      margin-right: auto;
      color: #333;
      box-shadow: 0 4px 8px rgba(0,0,0,0.12);
      text-align: left;
      font-size: 16px;
    }

    /* Floating Buttons */
    .floating-group { position: fixed; right: 20px; bottom: 20px; display: flex; gap: 10px; z-index: 9999; }
    .float-btn {
      background: #222; color: #fff; padding: 10px 14px; border-radius: 26px; border: none;
      font-weight: 700; cursor: pointer; box-shadow: 0 6px 14px rgba(0,0,0,0.25);
    }
    .float-btn:hover { background: #444; }

    /* Top-right theme toggle */
    #theme-toggle {
      position: fixed;
      top: 18px;
      right: 18px;
      z-index: 9999;
      background: rgba(255,255,255,0.85);
      border-radius: 22px;
      padding: 6px 10px;
      font-weight: 700;
      cursor: pointer;
      border: 1px solid rgba(0,0,0,0.06);
    }
    .dark #theme-toggle {
      background: rgba(0,0,0,0.5);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.06);
    }

    @media (max-width: 640px){
      .clock { width: 100%; }
      .search-container input { width: 100%; max-width: 360px; }
      .floating-group { right: 12px; bottom: 12px; gap: 8px; }
    }
  </style>
</head>
<body>
  <h1>üïí Maintenance Window Planner</h1>
  <p>Change any date/time ‚Äì all other time zones will update automatically.</p>

  <div class="search-container">
    <input id="city-search" type="text" placeholder="Search a city..." autocomplete="off" />
  </div>

  <div id="search-results"></div>

  <div class="clock-container" aria-hidden="false">
    <div class="clock">
      <h3>India (IST)</h3>
      <input type="date" id="ist-date" />
      <input type="time" id="ist-time" />
    </div>

    <div class="clock">
      <h3>Eastern (EST)</h3>
      <input type="date" id="est-date" />
      <input type="time" id="est-time" />
    </div>

    <div class="clock">
      <h3>Central (CST)</h3>
      <input type="date" id="cst-date" />
      <input type="time" id="cst-time" />
    </div>

    <div class="clock">
      <h3>Mountain (MST)</h3>
      <input type="date" id="mst-date" />
      <input type="time" id="mst-time" />
    </div>

    <div class="clock">
      <h3>Pacific (PST)</h3>
      <input type="date" id="pst-date" />
      <input type="time" id="pst-time" />
    </div>

    <div class="clock">
      <h3>Alaska (AKST)</h3>
      <input type="date" id="akst-date" />
      <input type="time" id="akst-time" />
    </div>

    <div class="clock">
      <h3>Hawaii (HST)</h3>
      <input type="date" id="hst-date" />
      <input type="time" id="hst-time" />
    </div>

    <div class="clock">
      <h3>Atlantic (AST)</h3>
      <input type="date" id="ast-date" />
      <input type="time" id="ast-time" />
    </div>
  </div>

  <div class="dst-info">
    <h3>üåû Daylight Saving Time Info</h3>
    <p>
      <strong>Starts:</strong> Second Sunday in March at 2:00 AM local time<br>
      <strong>Ends:</strong> First Sunday in November at 2:00 AM local time<br>
      Note: Not all time zones observe DST (e.g., AST, HST, AKST).
    </p>
  </div>

  <!-- Theme toggle top-right -->
  <button id="theme-toggle" title="Toggle light / dark">Toggle Theme</button>

  <!-- Floating group: Reset + Feedback -->
  <div class="floating-group">
    <button id="reset-now" class="float-btn" title="Reset all clocks to current IST time">‚ü≤ Reset to Now</button>
    <button id="feedback-btn" class="float-btn" title="Feedback / Request City"
      onclick="window.open('https://app.smartsheet.com/b/form/010b97732b974e3bb484f5efaddd2d82','_blank','noopener')">
      ‚ú® Feedback / Request City
    </button>
  </div>

  <script>
  /************************************************************************
   * NOTE: Clock logic below is the same corrected logic you confirmed.
   * I did NOT change the conversion algorithm; only added reset & theme.
   ************************************************************************/

  const timeZones = {
    ist: "Asia/Kolkata",
    est: "America/New_York",
    cst: "America/Chicago",
    mst: "America/Denver",
    pst: "America/Los_Angeles",
    akst: "America/Anchorage",
    hst: "Pacific/Honolulu",
    ast: "America/Halifax"
  };

  // Correct conversion function ‚Äî unchanged
  function updateAll(fromTz, dateValue, timeValue) {
    if (!dateValue || !timeValue) return;

    const localInput = `${dateValue}T${timeValue}:00`;
    const utcDate = new Date(
      new Date(localInput).toLocaleString("en-US", { timeZone: "UTC" })
    );

    for (const tzKey in timeZones) {
      const zoned = new Date(
        utcDate.toLocaleString("en-US", { timeZone: timeZones[tzKey] })
      );

      const y = zoned.getFullYear();
      const m = String(zoned.getMonth() + 1).padStart(2, "0");
      const d = String(zoned.getDate()).padStart(2, "0");
      const hh = String(zoned.getHours()).padStart(2, "0");
      const mm = String(zoned.getMinutes()).padStart(2, "0");

      const dateEl = document.getElementById(`${tzKey}-date`);
      const timeEl = document.getElementById(`${tzKey}-time`);
      if (dateEl) dateEl.value = `${y}-${m}-${d}`;
      if (timeEl) timeEl.value = `${hh}:${mm}`;
    }
  }

  // Attach listeners (unchanged)
  for (const tzKey in timeZones) {
    const dateEl = document.getElementById(`${tzKey}-date`);
    const timeEl = document.getElementById(`${tzKey}-time`);
    if (!dateEl || !timeEl) continue;

    dateEl.addEventListener("input", () => {
      updateAll(tzKey, dateEl.value, timeEl.value);
    });
    timeEl.addEventListener("input", () => {
      updateAll(tzKey, dateEl.value, timeEl.value);
    });
  }

  // Initialize to current IST time (unchanged)
  (function init() {
    const now = new Date();
    const istNow = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Kolkata" }));
    const y = istNow.getFullYear();
    const m = String(istNow.getMonth() + 1).padStart(2, "0");
    const d = String(istNow.getDate()).padStart(2, "0");
    const hh = String(istNow.getHours()).padStart(2, "0");
    const mm = String(istNow.getMinutes()).padStart(2, "0");

    updateAll("ist", `${y}-${m}-${d}`, `${hh}:${mm}`);
  })();

  /********** Reset-to-Now Button behavior **********/
  document.getElementById("reset-now").addEventListener("click", () => {
    const now = new Date();
    const istNow = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Kolkata" }));
    const y = istNow.getFullYear();
    const m = String(istNow.getMonth() + 1).padStart(2, "0");
    const d = String(istNow.getDate()).padStart(2, "0");
    const hh = String(istNow.getHours()).padStart(2, "0");
    const mm = String(istNow.getMinutes()).padStart(2, "0");

    // call the same updateAll with IST as base
    updateAll("ist", `${y}-${m}-${d}`, `${hh}:${mm}`);
  });

  /********** Light / Dark Mode Toggle **********/
  const themeBtn = document.getElementById("theme-toggle");
  const THEME_KEY = "tz_app_theme"; // 'dark' or 'light'

  function applyTheme(theme) {
    if (theme === "dark") {
      document.documentElement.classList.add("dark");
      themeBtn.textContent = "Dark";
    } else {
      document.documentElement.classList.remove("dark");
      themeBtn.textContent = "Light";
    }
    try { localStorage.setItem(THEME_KEY, theme); } catch(e) {}
  }

  // initialize theme from localStorage or preference
  (function initTheme() {
    let stored;
    try { stored = localStorage.getItem(THEME_KEY); } catch(e) { stored = null; }
    if (stored === "dark") { applyTheme("dark"); return; }
    if (stored === "light") { applyTheme("light"); return; }

    // fallback to prefers-color-scheme
    const prefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
    applyTheme(prefersDark ? "dark" : "light");
  })();

  themeBtn.addEventListener("click", () => {
    const isDark = document.documentElement.classList.contains("dark");
    applyTheme(isDark ? "light" : "dark");
  });

  /********** Search logic (unchanged) **********/
  const cityTimeZones = {
    "Albuquerque":"America/Denver","Aurora":"America/Denver","Austin":"America/Chicago",
    "Bayamon":"America/Puerto_Rico","Beltsville":"America/New_York","Bellevue":"America/Los_Angeles",
    "Birmingham":"America/Chicago","Bloomfield":"America/New_York","Boise":"America/Boise",
    "Bothell":"America/Los_Angeles","Branchburg":"America/New_York","Charlotte":"America/New_York",
    "Cheektowaga":"America/New_York","Cleveland":"America/New_York","Columbus":"America/New_York",
    "Dallas":"America/Chicago","Detroit":"America/Detroit","Draper":"America/Denver",
    "Eagan":"America/Chicago","El Monte":"America/Los_Angeles","El Paso":"America/Denver",
    "Elgin":"America/Chicago","Escondido":"America/Los_Angeles","Everglades":"America/New_York",
    "Fort Myers":"America/New_York","Fort Worth":"America/Chicago","Fresno":"America/Los_Angeles",
    "Hammond":"America/Chicago","Harrison":"America/New_York","Honolulu":"Pacific/Honolulu",
    "Houston":"America/Chicago","Indianapolis":"America/Indiana/Indianapolis","Irvine":"America/Los_Angeles",
    "Jacksonville":"America/New_York","Kansas City":"America/Chicago","Las Vegas":"America/Los_Angeles",
    "Little Rock":"America/Chicago","Livonia":"America/Detroit","Louisville":"America/Kentucky/Louisville",
    "McAllen":"America/Chicago","Memphis":"America/Chicago","Milwaukee":"America/Chicago",
    "Mobile":"America/Chicago","Nashville":"America/Chicago","New Berlin":"America/Chicago",
    "Norcross":"America/New_York","Norfolk":"America/New_York","Norristown":"America/New_York",
    "Norton":"America/New_York","Oakland":"America/Los_Angeles","Oklahoma City":"America/Chicago",
    "Omaha":"America/Chicago","Ontario":"America/Los_Angeles","Orlando":"America/New_York",
    "Pennsauken":"America/New_York","Phoenix":"America/Phoenix","Pittsburgh":"America/New_York",
    "Polaris":"America/Los_Angeles","Portland":"America/Los_Angeles","Providence":"America/New_York",
    "Riverside":"America/Los_Angeles","Sacramento":"America/Sacramento","San Francisco":"America/Los_Angeles",
    "Santa Clara":"America/Los_Angeles","Santa Fe Springs":"America/Los_Angeles","Simi Valley":"America/Los_Angeles",
    "St. Louis":"America/Chicago","Stockton":"America/Los_Angeles","Syosset":"America/New_York",
    "Syracuse":"America/New_York","Tampa":"America/New_York","Tempe":"America/Phoenix",
    "Titan":"America/Chicago","Torrance":"America/Los_Angeles","Wayne":"America/New_York",
    "Worthington":"America/Chicago","Halifax":"America/Halifax"
  };

  const tzAbbreviations = {
    "America/New_York": "EST","America/Detroit":"EST","America/Kentucky/Louisville":"EST",
    "America/Indiana/Indianapolis":"EST","America/Chicago":"CST","America/Boise":"MST",
    "America/Denver":"MST","America/Phoenix":"MST","America/Los_Angeles":"PST",
    "America/Anchorage":"AKST","Pacific/Honolulu":"HST","America/Puerto_Rico":"AST",
    "America/Halifax":"AST"
  };

  document.getElementById("city-search").addEventListener("input", function () {
    const query = this.value.trim().toLowerCase();
    const resultsDiv = document.getElementById("search-results");
    resultsDiv.innerHTML = "";

    if (!query) return;

    let matched = false;
    const shown = new Set();

    for (const city in cityTimeZones) {
      if (city.toLowerCase().includes(query) && !shown.has(city.toLowerCase())) {
        shown.add(city.toLowerCase());
        matched = true;

        const tz = cityTimeZones[city];
        const abbr = tzAbbreviations[tz] || tz.split("/").pop().replace("_", " ");

        const nowStr = new Date().toLocaleString("en-US", { timeZone: tz });
        const dt = new Date(nowStr);

        const dateStr = dt.toLocaleDateString("en-US");
        const timeStr = dt.toLocaleTimeString("en-US", { hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: true });

        const box = document.createElement("div");
        box.className = "search-result";
        box.innerHTML =
          `üìç <b>${city}</b><br>` +
          `Time Zone: <b>${abbr}</b><br>` +
          `Date: ${dateStr}<br>` +
          `Time: ${timeStr}`;

        resultsDiv.appendChild(box);
      }
    }

    if (!matched) {
      resultsDiv.innerHTML = `<div class="search-result">No matching city found.</div>`;
    }
  });

  </script>
</body>
</html>
